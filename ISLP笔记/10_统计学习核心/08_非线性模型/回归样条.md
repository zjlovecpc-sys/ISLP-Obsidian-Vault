---
tags:
  - 统计学习
  - 非线性模型
  - 样条
aliases:
  - Regression Splines
  - Cubic Spline
  - Natural Spline
  - Knots
  - 节点
---

# 回归样条 (Regression Splines)

## 1. 核心概念：分段多项式 (Piecewise Polynomials)
回归样条的本质是：**在不同的区间内拟合不同的低阶多项式，并在连接处（节点）保持平滑。**

### 节点 (Knots)
* 定义：$X$ 轴上切分区域的点 $\xi_1, \xi_2, \dots, \xi_K$。
* 只有节点越多，该区域的模型越灵活。

## 2. 三次样条 (Cubic Spline)
这是最常用的样条形式。它由以下约束定义：
1.  **分段三次**：每个区间也是 $d=3$ 的多项式。
2.  **连续性**：在节点处，曲线本身必须连续。
3.  **平滑性**：在节点处，**一阶导数**和**二阶导数**也必须连续。

**自由度计算**：
对于 $K$ 个节点的三次样条，自由度 $df = 4 + K$（如果包含截距）。
*(注：如果不含截距，df = K + 3)*

## 3. 截断幂基 (Truncated Power Basis)
这是构建样条最直观的数学方法。在模型中加入以下项：
$$h(x, \xi) = (x - \xi)_+^3 = \begin{cases} (x - \xi)^3 & \text{if } x > \xi \\ 0 & \text{otherwise} \end{cases}$$
一个包含 $K$ 个节点的三次样条模型写作：
$$y_i = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \sum_{k=1}^K \beta_{3+k} h(x, \xi_k) + \epsilon_i$$

## 4. 自然样条 (Natural Spline)
**MCM 推荐使用**。
* **问题**：普通多项式和样条在边界（数据范围的两端）方差非常大，预测极不稳定。
* **解决方案**：强制要求在第一个节点之前和最后一个节点之后，函数必须是**线性**的（而非三次）。
* **效果**：牺牲了边界的一点偏差，换取了边界处方差的显著降低（置信区间变窄）。

## 5. 节点选择策略
* **数量**：通过交叉验证 (CV) 选择最优的 $df$（自由度）。
* **位置**：通常选择分位数位置（如 25%, 50%, 75%），确保每个区间内有足够的数据点。

## 关联笔记
* ⬅️ 基础形式：[[多项式回归与阶梯函数]]
* 🔄 另一种路径：[[平滑样条]] (不通过基函数，而是通过惩罚项来实现平滑)。