---
tags:
  - 统计学习
  - 非线性模型
  - 特征工程
aliases:
  - Polynomial Regression
  - Step Functions
  - 分箱
  - Binning
---

# 多项式回归与阶梯函数

## 1. 多项式回归 (Polynomial Regression)

### 定义
通过增加预测变量的高次项来扩展线性模型：
$$y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \dots + \beta_d x_i^d + \epsilon_i$$

### 关键特性
* **自由度 (df)**：$d$ 阶多项式消耗 $d+1$ 个自由度（含截距）。通常 $d$ 取 3 或 4 即可，过大的 $d$ 会导致**龙格现象 (Runge's Phenomenon)**，即曲线在边缘处剧烈震荡。
* **正交多项式**：在计算标准误时，通常使用正交多项式（Orthogonal Polynomials）以避免项之间的共线性，但这不影响拟合的预测值。

### 编程手警示
* **尾部不稳定**：多项式回归在数据范围之外（Extrapolation）极其不可靠。
* **逻辑回归应用**：在 [[逻辑回归]] 中，同样可以引入 $X^2$ 来建模非线性的 Log-Odds。

---

## 2. 阶梯函数 (Step Functions)

### 定义
将连续变量 $X$ 转换为有序的**类别变量**。创建 $K$ 个截断点 (Cutpoints) $c_1, c_2, \dots, c_K$，构建 $K+1$ 个区间。
$$y_i = \beta_0 + \beta_1 I(c_1 < x_i < c_2) + \dots + \beta_K I(c_K < x_i < c_{K+1}) + \epsilon_i$$
其中 $I(\cdot)$ 是示性函数（Dummy Variable）。

### 优缺点
* **优点**：能够捕捉明显的“断层”效应（如：以 35 岁和 60 岁为界，工资结构突变）。
* **缺点**：模型是不连续的，在切分点处会发生跳跃，这通常不符合物理规律（自然界的变化通常是连续的）。

## 关联笔记
* ➡️ 进化版本：为了解决阶梯函数的不连续性，我们引入了 [[回归样条]]。